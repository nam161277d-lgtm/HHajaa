<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>DEV WITE • ADMIN</title>

<style>
body{margin:0;background:#020617;color:#e5e7eb;font-family:-apple-system}
.container{max-width:420px;margin:auto;padding:16px}
.card{background:#0b1220;border-radius:18px;padding:18px;margin-top:16px}
input,button{
  width:100%;padding:14px;border-radius:14px;
  border:none;font-size:15px;margin-top:10px
}
input{background:#020617;color:#e5e7eb}
button{font-weight:600}
.blue{background:#2563eb;color:#fff}
.red{background:#dc2626;color:#fff}
.green{background:#22c55e;color:#04110a}
</style>
</head>

<body>
<div class="container">

<div class="card" id="login">
  <h3>Admin Login</h3>
  <input id="u" placeholder="user">
  <input id="p" type="password" placeholder="pass">
  <button class="blue" onclick="login()">Login</button>
</div>

<div class="card" id="panel" style="display:none">
  <h3>Cấp ngày</h3>
  <input id="phone">
  <input id="days">
  <button class="green" onclick="grant()">Cấp</button>

  <h3>Reset MK</h3>
  <input id="rp">
  <input id="rmk">
  <button class="red" onclick="reset()">Reset</button>

  <h3>2FA User</h3>
  <div id="list"></div>
</div>
</div>

<script>
const ACC="DEVWITE_ACCOUNTS";
function getAcc(){return JSON.parse(localStorage.getItem(ACC)||"{}")}
function saveAcc(a){localStorage.setItem(ACC,JSON.stringify(a))}

function login(){
  if(u.value==="admin"&&p.value==="nam16127@"){
    login.style.display="none";
    panel.style.display="block";
    render();
  }
}

function grant(){
  const a=getAcc();
  const d=new Date();
  d.setDate(d.getDate()+parseInt(days.value));
  a[phone.value].expire=d.toISOString().slice(0,10);
  saveAcc(a);
  alert("Đã cấp");
}

async function reset(){
  const b=await crypto.subtle.digest("SHA-256",new TextEncoder().encode(rmk.value));
  const h=[...new Uint8Array(b)].map(x=>x.toString(16).padStart(2,"0")).join("");
  const a=getAcc();
  a[rp.value].pass=h;
  saveAcc(a);
  alert("Reset xong");
}

function render(){
  const a=getAcc();
  list.innerHTML="";
  for(const k in a){
    if(a[k].twofa){
      list.innerHTML+=`<div><b>${k}</b><br>${a[k].twofa.map(x=>x.name).join(", ")}</div>`;
    }
  }
}
</script>
</body>
</html>
