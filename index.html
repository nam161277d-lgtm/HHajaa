<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DEV WITE Tool</title>

<style>
*{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont}
body{
  margin:0;
  background:linear-gradient(180deg,#05070c,#0a0f1c);
  color:#e5e7eb;
  display:flex;
  justify-content:center;
}
.container{width:100%;max-width:420px;padding:16px}
.card{
  background:#0b1220;
  border-radius:18px;
  padding:18px;
  margin-top:16px;
  box-shadow:0 20px 60px rgba(0,0,0,.6)
}
h1{text-align:center;color:#3b82f6;margin:0}
.sub{text-align:center;color:#9ca3af;font-size:13px;margin-bottom:10px}
input,button{
  width:100%;
  padding:14px;
  border-radius:14px;
  border:none;
  font-size:16px;
}
input{
  background:#020617;
  color:#e5e7eb;
  margin-bottom:10px;
}
button{font-weight:700;cursor:pointer}
.blue{background:#2563eb;color:#fff}
.gray{background:#1f2937;color:#e5e7eb}
.green{background:#22c55e;color:#04110a}
.row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.hide{display:none}
.nav{display:flex;gap:8px;margin-bottom:10px}
.nav button{flex:1}
.code{
  background:#020617;
  border-radius:12px;
  padding:12px;
  margin-top:8px;
  font-size:28px;
  letter-spacing:4px;
  text-align:center;
  color:#00ff9c
}
.qrbox{text-align:center;margin-top:10px}
.qrbox img{width:200px;background:#fff;padding:8px;border-radius:12px}
.small{text-align:center;font-size:12px;color:#9ca3af;margin-top:6px}
</style>
</head>

<body>
<div class="container">

<!-- LOGIN / REGISTER -->
<div id="loginBox" class="card">
  <h1>DEV WITE</h1>
  <div class="sub">ÄÄƒng kÃ½ / ÄÄƒng nháº­p Ä‘á»ƒ sá»­ dá»¥ng tool</div>

  <input id="phone" placeholder="Sá»‘ Ä‘iá»‡n thoáº¡i" autocomplete="off" inputmode="numeric">
  <input id="pass" type="password" placeholder="Máº­t kháº©u" autocomplete="new-password">

  <button class="blue" type="button" onclick="login()">ÄÄƒng kÃ½ / ÄÄƒng nháº­p</button>
</div>

<!-- APP -->
<div id="app" class="card hide">
  <h1>DEV WITE</h1>
  <div class="sub" id="statusText"></div>

  <div class="nav">
    <button class="gray" type="button" onclick="showTab('pass')">Change Pass</button>
    <button class="gray" type="button" onclick="showTab('fa')">2FA (FREE)</button>
  </div>

  <!-- CHANGE PASS -->
  <div id="passTab" class="hide">
    <div id="lockNote" class="small"></div>

    <input id="uid" placeholder="UID">
    <input id="code" placeholder="CODE MAIL">

    <button id="genBtn" class="blue" type="button" onclick="genLinks()">Táº¡o link</button>

    <div class="row">
      <button class="gray" type="button" onclick="openLink(1)">Ver1</button>
      <button class="gray" type="button" onclick="openLink(2)">Ver2</button>
    </div>
    <button class="gray" type="button" onclick="openLink(3)">Ver3</button>

    <button class="gray" type="button" onclick="openRenew()">Gia háº¡n</button>

    <div class="qrbox" id="qrBox" style="display:none">
      <img id="qrImg">
      <div class="small">QR theo link Ä‘ang má»Ÿ</div>
    </div>
  </div>

  <!-- 2FA -->
  <div id="faTab" class="hide">
    <input id="secret" placeholder="Nháº­p 2FA Secret (Base32)">
    <div class="row">
      <button class="green" type="button" onclick="gen2FA()">GET MÃƒ</button>
      <button class="gray" type="button" onclick="copy2FA()">Copy</button>
    </div>
    <div id="totp" class="code">------</div>
  </div>

  <button class="gray" style="margin-top:10px" type="button" onclick="logout()">ÄÄƒng xuáº¥t</button>
</div>

</div>

<!-- POPUP GIA Háº N -->
<div id="renewModal" style="
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  z-index:999;
  justify-content:center;
  align-items:center;
">
  <div style="
    background:#0b1220;
    border-radius:16px;
    padding:20px;
    max-width:320px;
    width:90%;
    text-align:center;
  ">
    <h3 style="margin:0;color:#3b82f6">Gia háº¡n Change Pass</h3>
    <p style="color:#9ca3af;font-size:14px;margin:12px 0">
      Vui lÃ²ng liÃªn há»‡ Telegram admin Ä‘á»ƒ gia háº¡n sá»­ dá»¥ng
    </p>

    <a href="https://t.me/wite_dev" target="_blank"
       style="
         display:block;
         background:#2563eb;
         color:white;
         padding:12px;
         border-radius:12px;
         font-weight:700;
         text-decoration:none;
         margin-bottom:10px
       ">
      ğŸ“© @wite_dev
    </a>

    <button class="gray" type="button" onclick="closeRenew()">ÄÃ³ng</button>
  </div>
</div>

<script>
/* ===== STORAGE ===== */
const LOGIN_KEY="DEVWITE_LOGIN";
const USERS_KEY="DEVWITE_USERS";

/* ===== LOGIN ===== */
function login(){
  const p=phone.value.trim();
  const pw=pass.value.trim();
  if(!p||!pw){alert("Thiáº¿u thÃ´ng tin");return;}
  localStorage.setItem(LOGIN_KEY,p);
  phone.value=pass.value="";
  loadUser();
}
function logout(){
  localStorage.removeItem(LOGIN_KEY);
  location.reload();
}

/* ===== LOAD USER ===== */
function loadUser(){
  const p=localStorage.getItem(LOGIN_KEY);
  if(!p)return;
  loginBox.classList.add("hide");
  app.classList.remove("hide");

  const users=JSON.parse(localStorage.getItem(USERS_KEY)||"{}");
  const u=users[p];
  const active=u && new Date(u.expire)>new Date();

  statusText.innerText=active
    ?"âœ” Change Pass Ä‘ang hoáº¡t Ä‘á»™ng"
    :"ğŸ”’ Change Pass chÆ°a Ä‘Æ°á»£c kÃ­ch hoáº¡t";

  genBtn.disabled=!active;
  lockNote.innerText=active?"":"Change Pass bá»‹ khÃ³a â€“ vui lÃ²ng gia háº¡n";
  showTab("fa");
}

/* ===== NAV ===== */
function showTab(t){
  passTab.classList.add("hide");
  faTab.classList.add("hide");
  if(t==="pass")passTab.classList.remove("hide");
  if(t==="fa")faTab.classList.remove("hide");
}

/* ===== CHANGE PASS ===== */
let links={};
function genLinks(){
  const u=uid.value.trim();
  const c=code.value.trim();
  if(!u||!c){alert("Thiáº¿u UID hoáº·c CODE");return;}

  links[1]=`https://www.site.com/recover/password/?u=${encodeURIComponent(u)}&n=${encodeURIComponent(c)}&fl=default_recover&sih=0&ssb=1&msgr=0&rm=send_email`;
  links[2]=`https://www.site.com/recover/password/?u=${encodeURIComponent(u)}&n=${encodeURIComponent(c)}&fl=in_autosend_experiment&sih=0&ssb=1&msgr=0&rm=send_email`;
  links[3]=`https://www.site.com/recover/password/?u=${encodeURIComponent(u)}&n=${encodeURIComponent(c)}&fl=default_recover&sih=0&ssb=1&msgr=0&rm=send_email&_rdc=1&_rdr#`;
}
function openLink(v){
  if(!links[v]){alert("ChÆ°a táº¡o link");return;}
  window.open(links[v],"_blank");
  qrImg.src="https://api.qrserver.com/v1/create-qr-code/?size=300x300&data="+encodeURIComponent(links[v]);
  qrBox.style.display="block";
}

/* ===== 2FA ===== */
async function gen2FA(){
  const s=secret.value.trim();
  if(!s)return;
  totp.innerText=await makeTOTP(s);
}
function copy2FA(){
  navigator.clipboard.writeText(totp.innerText);
}

/* ===== TOTP ===== */
const base32="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";
function b32(s){
  s=s.replace(/=+$/,'').toUpperCase();let b='',o=[];
  for(const c of s){const v=base32.indexOf(c);if(v>-1)b+=v.toString(2).padStart(5,'0')}
  for(let i=0;i+8<=b.length;i+=8)o.push(parseInt(b.slice(i,i+8),2));
  return new Uint8Array(o);
}
async function makeTOTP(sec){
  const k=b32(sec),t=Math.floor(Date.now()/1000/30);
  const buf=new ArrayBuffer(8);new DataView(buf).setUint32(4,t);
  const key=await crypto.subtle.importKey('raw',k,{name:'HMAC',hash:'SHA-1'},false,['sign']);
  const h=new Uint8Array(await crypto.subtle.sign('HMAC',key,buf));
  const o=h[h.length-1]&0xf;
  return ((((h[o]&0x7f)<<24)|(h[o+1]<<16)|(h[o+2]<<8)|h[o+3])%1e6).toString().padStart(6,'0');
}

/* ===== RENEW ===== */
function openRenew(){renewModal.style.display="flex";}
function closeRenew(){renewModal.style.display="none";}

/* AUTO */
loadUser();
</script>
</body>
</html>
