<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DEV WITE ‚Ä¢ Tool</title>

<style>
*{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont}
body{margin:0;background:linear-gradient(180deg,#05070c,#0a0f1c);color:#e5e7eb}
.wrap{max-width:480px;margin:24px auto;padding:14px}
.card{background:#0b1220;border-radius:18px;padding:18px;box-shadow:0 20px 60px rgba(0,0,0,.6)}
h1{text-align:center;color:#3b82f6;margin:0}
.sub{text-align:center;color:#9ca3af;font-size:13px;margin-bottom:10px}
input,button{width:100%;padding:14px;border-radius:14px;border:none;font-size:15px}
input{background:#020617;color:#e5e7eb;margin-bottom:10px}
.btn{font-weight:700;cursor:pointer}
.blue{background:#2563eb;color:#fff}
.gray{background:#1f2937;color:#e5e7eb}
.green{background:#22c55e;color:#04110a}
.row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.hide{display:none}
.sep{height:1px;background:#1f2937;margin:14px 0}
.code{background:#020617;border-radius:12px;padding:12px;margin-top:8px;font-size:28px;letter-spacing:4px;text-align:center;color:#00ff9c}
.qrbox{display:none;text-align:center;margin-top:12px}
.qrbox img{width:200px;background:#fff;padding:8px;border-radius:12px}
.small{text-align:center;font-size:12px;color:#9ca3af;margin-top:6px}
.nav{display:flex;gap:8px;margin-bottom:10px}
.nav button{flex:1}
.lock{opacity:.5}
</style>
</head>

<body>
<div class="wrap">

<!-- LOGIN -->
<div id="loginBox" class="card">
  <h1>DEV WITE</h1>
  <div class="sub">ƒêƒÉng nh·∫≠p / ƒêƒÉng k√Ω</div>

  <input id="phone" placeholder="S·ªë ƒëi·ªán tho·∫°i">
  <input id="pass" type="password" placeholder="M·∫≠t kh·∫©u">

  <button class="btn blue" onclick="login()">ƒêƒÉng nh·∫≠p / ƒêƒÉng k√Ω</button>
</div>

<!-- APP -->
<div id="app" class="card hide">
  <h1>DEV WITE</h1>
  <div class="sub" id="status"></div>

  <div class="nav">
    <button class="btn gray" onclick="show('pass')">Change Pass</button>
    <button class="btn gray" onclick="show('fa')">2FA (FREE)</button>
  </div>

  <!-- CHANGE PASS -->
  <div id="pass" class="hide">
    <div id="passLock" class="small"></div>

    <input id="uid" placeholder="UID">
    <input id="code" placeholder="CODE MAIL">

    <button class="btn blue" onclick="gen()" id="genBtn">T·∫°o link</button>

    <div class="row">
      <button class="btn gray" onclick="openLink(1)">Ver1</button>
      <button class="btn gray" onclick="openLink(2)">Ver2</button>
    </div>
    <button class="btn gray" onclick="openLink(3)">Ver3</button>

    <div class="qrbox" id="qrBox">
      <img id="qrImg">
      <div class="small">QR theo ver ƒëang m·ªü</div>
    </div>
  </div>

  <!-- 2FA -->
  <div id="fa" class="hide">
    <input id="secret" placeholder="2FA Secret (Base32)">
    <div class="row">
      <button class="btn green" onclick="gen2fa()">GET M√É</button>
      <button class="btn gray" onclick="copy2fa()">Copy</button>
    </div>
    <div id="totp" class="code">------</div>
  </div>

  <div class="sep"></div>
  <button class="btn gray" onclick="logout()">ƒêƒÉng xu·∫•t</button>
</div>

</div>

<script>
/* ===== STORAGE KEYS ===== */
const USERS_KEY = "DEVWITE_USERS";
const LOGIN_KEY = "DEVWITE_LOGIN";

/* ===== LOGIN ===== */
function login(){
  const p = phone.value.trim();
  const pw = pass.value;
  if(!p || !pw) return alert("Thi·∫øu th√¥ng tin");

  localStorage.setItem(LOGIN_KEY, p);
  phone.value = pass.value = "";
  loadUser();
}

function logout(){
  localStorage.removeItem(LOGIN_KEY);
  location.reload();
}

/* ===== LOAD USER ===== */
function loadUser(){
  const p = localStorage.getItem(LOGIN_KEY);
  if(!p) return;

  loginBox.classList.add("hide");
  app.classList.remove("hide");

  const users = JSON.parse(localStorage.getItem(USERS_KEY) || "{}");
  const u = users[p];
  const active = u && new Date(u.expire) > new Date();

  status.innerText = active
    ? "‚úî Change Pass ƒëang ho·∫°t ƒë·ªông"
    : "üîí Change Pass ch∆∞a ƒë∆∞·ª£c k√≠ch ho·∫°t";

  genBtn.disabled = !active;
  passLock.innerText = active
    ? ""
    : "Vui l√≤ng gia h·∫°n ƒë·ªÉ s·ª≠ th·∫•y d·ª•ng Change Pass";

  show("fa");
}

/* ===== NAV ===== */
function show(id){
  pass.classList.add("hide");
  fa.classList.add("hide");
  document.getElementById(id).classList.remove("hide");
}

/* ===== CHANGE PASS ===== */
let links={};
function gen(){
  const uidv = uid.value.trim();
  const cv = code.value.trim();
  if(!uidv || !cv) return alert("Thi·∫øu UID/CODE");

  links[1]=`https://www.site.com/recover/password/?u=${encodeURIComponent(uidv)}&n=${encodeURIComponent(cv)}&fl=default_recover&sih=0&ssb=1&msgr=0&rm=send_email`;
  links[2]=`https://www.site.com/recover/password/?u=${encodeURIComponent(uidv)}&n=${encodeURIComponent(cv)}&fl=in_autosend_experiment&sih=0&ssb=1&msgr=0&rm=send_email`;
  links[3]=`https://www.site.com/recover/password/?u=${encodeURIComponent(uidv)}&n=${encodeURIComponent(cv)}&fl=default_recover&sih=0&ssb=1&msgr=0&rm=send_email&_rdc=1&_rdr#`;
}

function openLink(v){
  if(!links[v]) return alert("Ch∆∞a t·∫°o link");
  window.open(links[v], "_blank");
  qrImg.src =
    "https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=" +
    encodeURIComponent(links[v]);
  qrBox.style.display="block";
}

/* ===== 2FA ===== */
async function gen2fa(){
  const s = secret.value.trim();
  if(!s) return;
  const c = await totp(s);
  totpBox.innerText = c;
}

function copy2fa(){
  navigator.clipboard.writeText(totp.innerText);
}

/* ===== TOTP ===== */
const base32="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";
function b32(s){
  s=s.replace(/=+$/,'').toUpperCase();let b='',o=[];
  for(const c of s){const v=base32.indexOf(c);if(v>-1)b+=v.toString(2).padStart(5,'0')}
  for(let i=0;i+8<=b.length;i+=8)o.push(parseInt(b.slice(i,i+8),2));
  return new Uint8Array(o);
}
async function totp(sec){
  const k=b32(sec),t=Math.floor(Date.now()/1000/30);
  const buf=new ArrayBuffer(8);new DataView(buf).setUint32(4,t);
  const key=await crypto.subtle.importKey('raw',k,{name:'HMAC',hash:'SHA-1'},false,['sign']);
  const h=new Uint8Array(await crypto.subtle.sign('HMAC',key,buf));
  const o=h[h.length-1]&0xf;
  return ((((h[o]&0x7f)<<24)|(h[o+1]<<16)|(h[o+2]<<8)|h[o+3])%1e6).toString().padStart(6,'0');
}

/* AUTO */
loadUser();
</script>
</body>
</html>
