<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DEV WITE TOOL</title>

<style>
:root{
  --bg:#0b0f19;
  --card:#121826;
  --border:#1f2937;
  --text:#e5e7eb;
  --muted:#9ca3af;
  --primary:#3b82f6;
  --success:#22c55e;
}
*{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  min-height:100vh;
  display:flex;
  justify-content:center
}
.container{
  width:100%;
  max-width:420px;
  padding:16px
}
.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:16px;
  padding:18px;
  margin-top:16px
}
h1{
  text-align:center;
  margin:0;
  color:var(--primary)
}
.sub{
  text-align:center;
  color:var(--muted);
  font-size:13px;
  margin-bottom:10px
}
input,button{
  width:100%;
  padding:14px;
  border-radius:12px;
  border:1px solid var(--border);
  background:#0f172a;
  color:var(--text);
  font-size:15px;
  margin-top:10px
}
button{
  cursor:pointer;
  font-weight:600
}
.btn-primary{background:var(--primary);border:none}
.btn-ghost{background:#0f172a}
.btn-danger{background:#ef4444;border:none}
.hide{display:none}
.tabs{
  display:flex;
  gap:8px;
  margin-bottom:10px
}
.tabs button{flex:1}
.code{
  text-align:center;
  font-size:30px;
  letter-spacing:4px;
  margin-top:10px
}
.avatar{
  position:fixed;
  top:12px;
  right:12px;
  width:38px;
  height:38px;
  border-radius:50%;
  background:var(--primary);
  display:none;
  justify-content:center;
  align-items:center;
  font-weight:700;
  cursor:pointer;
  z-index:10
}
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:20
}
.modal-box{
  background:var(--card);
  border-radius:16px;
  padding:20px;
  width:90%;
  max-width:320px
}
</style>
</head>

<body>

<div class="avatar" id="avatar">U</div>

<div class="container">

<!-- AUTH -->
<div id="authBox" class="card">
  <h1>DEV WITE</h1>
  <div class="sub">ƒêƒÉng k√Ω / ƒêƒÉng nh·∫≠p</div>

  <input id="phone" placeholder="S·ªë ƒëi·ªán tho·∫°i">
  <input id="pass" type="password" placeholder="M·∫≠t kh·∫©u">

  <button class="btn-primary" onclick="register()">ƒêƒÉng k√Ω</button>
  <button class="btn-ghost" onclick="login()">ƒêƒÉng nh·∫≠p</button>

  <div id="msg" class="sub"></div>
</div>

<!-- APP -->
<div id="app" class="card hide">
  <div class="tabs">
    <button onclick="showTab('pass')">Change Pass</button>
    <button onclick="showTab('renew')">Gia h·∫°n</button>
  </div>

  <!-- CHANGE PASS -->
  <div id="passTab" class="hide">
    <input id="uid" placeholder="UID">
    <input id="code" placeholder="CODE MAIL">

    <button class="btn-primary" onclick="genLinks()">T·∫°o link</button>

    <button onclick="openLink(1)">Ver 1</button>
    <button onclick="openLink(2)">Ver 2</button>
    <button onclick="openLink(3)">Ver 3</button>

    <!-- QR -->
    <div id="qrBox" style="margin-top:14px;text-align:center"></div>

    <!-- SMART STATUS -->
    <div id="smartStatus"
         style="
           margin-top:8px;
           font-size:12px;
           color:#22c55e;
           opacity:0;
           transition:opacity .3s;
           text-align:center
         ">
    </div>
  </div>

  <!-- RENEW -->
  <div id="renewTab" class="hide">
    <div class="sub">Li√™n h·ªá admin ƒë·ªÉ gia h·∫°n</div>
    <a href="https://t.me/wite_dev" target="_blank">
      <button class="btn-primary">Telegram @wite_dev</button>
    </a>
  </div>

  <button class="btn-danger" onclick="logout()">ƒêƒÉng xu·∫•t</button>
</div>

</div>

<script>
/* ===== STORAGE ===== */
const ACC_KEY="DEVWITE_ACCOUNTS";
const LOGIN_KEY="DEVWITE_LOGIN";

/* ===== HELPERS ===== */
function getAcc(){
  return JSON.parse(localStorage.getItem(ACC_KEY)||"{}");
}
function saveAcc(a){
  localStorage.setItem(ACC_KEY,JSON.stringify(a));
}
async function hash(t){
  const b=await crypto.subtle.digest(
    "SHA-256",
    new TextEncoder().encode(t)
  );
  return [...new Uint8Array(b)]
    .map(x=>x.toString(16).padStart(2,"0"))
    .join("");
}

/* ===== AUTH ===== */
async function register(){
  const a=getAcc();
  if(a[phone.value]){
    msg.innerText="T√†i kho·∫£n ƒë√£ t·ªìn t·∫°i";
    return;
  }
  a[phone.value]={pass:await hash(pass.value)};
  saveAcc(a);
  msg.innerText="ƒêƒÉng k√Ω th√†nh c√¥ng";
}

async function login(){
  const a=getAcc();
  if(!a[phone.value]){
    msg.innerText="T√†i kho·∫£n kh√¥ng t·ªìn t·∫°i";
    return;
  }
  if(a[phone.value].pass!==await hash(pass.value)){
    msg.innerText="Sai m·∫≠t kh·∫©u";
    return;
  }
  localStorage.setItem(LOGIN_KEY,phone.value);
  location.reload();
}

function logout(){
  localStorage.removeItem(LOGIN_KEY);
  location.reload();
}

/* ===== UI ===== */
function showTab(t){
  passTab.classList.add("hide");
  renewTab.classList.add("hide");
  document.getElementById(t+"Tab").classList.remove("hide");
}

/* ===== CHANGE PASS ===== */
let links={};
let currentVer=null;
let smartTimer=null;

function genLinks(){
  links={
    1:`https://www.site.com/recover/password/?u=${uid.value}&n=${code.value}`,
    2:`https://www.site.com/recover/password/?u=${uid.value}&n=${code.value}&v=2`,
    3:`https://www.site.com/recover/password/?u=${uid.value}&n=${code.value}&v=3`
  };
  showStatus("Link ƒë√£ s·∫µn s√†ng");
  autoUpdateQR();
}

function openLink(v){
  if(!links[v]) return;
  currentVer=v;
  const url=links[v];

  if(event && event.isTrusted){
    window.open(url,"_blank");
  }

  document.getElementById("qrBox").innerHTML=`
    <div style="font-size:13px;color:#9ca3af;margin-bottom:6px">
      QR Change Pass ‚Äì Ver ${v}
    </div>
    <img
      src="https://api.qrserver.com/v1/create-qr-code/?size=220x220&data=${encodeURIComponent(url)}"
      style="border-radius:12px;border:1px solid #1f2937"
    >
    <div style="margin-top:8px">
      <button onclick="copyLink('${url}')"
        style="
          padding:10px 14px;
          border-radius:10px;
          border:none;
          background:#1f2937;
          color:#e5e7eb;
          cursor:pointer
        ">
        üìã Copy link Ver ${v}
      </button>
    </div>
  `;
  showStatus("QR ƒë√£ c·∫≠p nh·∫≠t");
}

function copyLink(text){
  navigator.clipboard.writeText(text);
}

function showStatus(text){
  const el=document.getElementById("smartStatus");
  el.innerText="‚úî "+text;
  el.style.opacity=1;
  if(smartTimer) clearTimeout(smartTimer);
  smartTimer=setTimeout(()=>{el.style.opacity=0},1200);
}

function autoUpdateQR(){
  if(!currentVer) return;
  genLinksOnly();
  openLink(currentVer);
}

function genLinksOnly(){
  links={
    1:`https://www.site.com/recover/password/?u=${uid.value}&n=${code.value}`,
    2:`https://www.site.com/recover/password/?u=${uid.value}&n=${code.value}&v=2`,
    3:`https://www.site.com/recover/password/?u=${uid.value}&n=${code.value}&v=3`
  };
}

uid.addEventListener("input",autoUpdateQR);
code.addEventListener("input",autoUpdateQR);

/* ===== INIT ===== */
const cur=localStorage.getItem(LOGIN_KEY);
if(cur){
  authBox.classList.add("hide");
  app.classList.remove("hide");
  avatar.style.display="flex";
  avatar.innerText=cur[0].toUpperCase();
}
</script>

</body>
</html>
